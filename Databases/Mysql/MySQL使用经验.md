## 1. MySQL多次单表查询和多表联合查询，那个效率更高？

很多高性能应用都会对关联查询进行分解。

例如有如下多表连个查询SQL语句：

```mysql
SELECT *
FROM user u
	INNER JOIN account a ON u.id = a.user_id
	INNER JOIN amount am ON a.id = am.account_id
WHERE u.name = 'just';
```

可以分解成下面这些查询来代替：

```mysql
SELECT * FROM user WHERE name = 'just';
SELECT * FROM account WHERE id = 71561;
SELECT * FROM amount WHERE id = 15489;
```

**Why?**

咋一看，这样做并没有什么好处，反而可能还会有很多坏处。可以想到的坏处如下：

1. 原本一条SQL可以完成的事，现在变成了3条，代码变得复杂了。
2. 原本一次与数据库的IO交互，现在变成3次，一次请求的效率更慢。

事实上，分解多表联合查询有如下优势：

1. 缓存效率更高。

   许多应用程序可以很方便的对单表查询的结果进行缓存，例如Mybatis，而对于多表联合查询就不太好使了。 

   多表联合查询，如果关联的表之一发生了变化，那么就无法使用查询缓存了。

   而拆分之后，即使某个表发生变化，也不会对其他查询缓存产生影响，特别是对于那些很少发生变化的表。

2. 将查询分解之后，执行单个查询可以减少锁的竞争。

3. 在应用层做拆分，可以更容易对数据库进行拆分，更容易做到高性能和可扩展。

4. 单表查询更易于应用到索引，查询效率在多次IO的情况下反而可能会有所提升。

5. 可以减少冗余记录的查询。

6. 相当于与在应用中实现了哈希关联，而不是使用MySQL的嵌套环关联，某些场景下哈希关联效率更高。

## 2. 按条件分组，查询每组前(后)N条数据