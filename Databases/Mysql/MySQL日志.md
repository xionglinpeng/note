# MySQL日志

## 一、 日志简介

MySQL日志主要分4类：

1. 错误日志：记录MySQL服务的启动、运行或停止MySQL服务时出现的问题。
2. 查询日志：记录建立的客户端连接和执行的语句。
3. 二进制日志：记录所有更改数据的语句，可以用于数据复制。
4. 慢查询日志：记录所有执行时间超过`long_query_time`的所有查询或不使用索引的查询。

默认情况下，所有日志创建于MySQL数据目录中。通过刷新日志，可以强制MySQL关闭和重新打开日志文件（或者在某些情况下切换到一个新的日志）。当执行一个`FLUSH LOGS`语句或执行`MySQLadmin flush-logs`或`MySQLadmin refresh`时，将刷新日志。

如果正使用MySQL复制功能，在复制服务器上可以维护更多日志文件，这种日志称为接替日志。

启动日志功能会降低MySQL数据库的性能。例如，在查询非常频繁的MySQL数据库系统中，如果开启了通用查询日志和慢查询日志，MySQL数据库会花费更多的时间记录日志，同时，日志会占用大量的磁盘空间。

## 二、二进制日志



### 1. 启动和设置二进制日志

默认情况下，二进制日志是开启的，可以通过修改MySQL的配置文件来启动和设置二进制日志。

my.ini中，`[MySQLd]`组下面有关于二进制日志的设置：

```
log-bin [=path/ [filename]]
```

- log-bin：定义可以二进制日志。
- path：表明日志文件所在的目录路径。
- filename：指定了日志文件的名称，如文件的全名为

expire_logs_days：定义了MySQL清楚过期日志的时间，即二进制日志指定删除的天数。默认值为0，表示“没有指定删除”。当MySQL启动或刷新二进制日志时可能删除该文件。

max_binlog_size：定义了单个文件的大小限制，如果二进制日志写入的内容超出给定值，日志就会发生滚动（关闭当前文件，重新打开一个新的日志文件）。不能将该变量设置为大于1GB或小于4096B，默认值是1GB。