# Mysql数据类型和运算符



## 1. Mysql数据类型

MySQL支持多种数据类型，主要有数值类型，日期/时间类型和字符串类型。

1. 数值类型：

   整数类型：TINYINT、SMALLINT、MEDIUMINT、INT、BIGINT。

   浮点小数类型：FLOAT、DOUBLE。

   定点小数类型：DECIMAL。

2. 日期/时间类型：YEAR、TIME、DATE、DATETIME、TIMESTAMP。

3. 字符串类型：

   文本字符串类型：CHAR、VARCHAR、TEXT、ENUM、SET

   二进制字符串类型：BINAYY、VARBINARY、BLOB

### 1.1.1、整数类型

数值数据类型主要用来存储数字，MySQL提供了多种数值数据类型，不同的数据类型根据不同的取值范围，可以存储的值范围越大，其所需要的存储空间也会越大。MySQL主要提供的整数类型有TINYINT、SMALLINT、MEDIUMINT、INT、BIGINT。整数类型的属性字段可以添加`AUTO_INCREMENT`自增约束条件。

*MySQL中的整数数据类型*

| 类型名称  | 说明           | 存储需求 |
| --------- | -------------- | -------- |
| TINYINT   | 很小的整数     | 1字节    |
| SMALLINT  | 小的整数       | 2字节    |
| MEDIUMINT | 中等大小的整数 | 3字节    |
| INT       | 普通大小的整数 | 4字节    |
| BIGINT    | 大整数         | 8字节    |

不同整数类型的取值范围

| 类型名称  | 有符号                                   | 无符号                 |
| --------- | ---------------------------------------- | ---------------------- |
| TINYINT   | -128~127                                 | 0~255                  |
| SMALLINT  | 32768~32767                              | 0-65535                |
| MEDIUMINT | -8388608~8388607                         | 0~16777215             |
| INT       | 普通大小的整数                           | 0~4294967295           |
| BIGINT    | -9223372036854775808~9223372036854775807 | 0~18446744073709551615 |

不同的整数类型有不同的取值范围，并且需要不同的存储空间，因此应该根据实际需要选择最合适的类型，这样有利于提高查询的效率和节省存储空间。

示例：

```mysql
CREATE TABLE temp (
   x TINYINT,
   y SMALLINT,
   z MEDIUMINT,
   m INT,
   n BIGINT
);
```

### 1.1.2、浮点数类型和定点数类型

MySQL使用浮点数和顶点数来表示小数。

浮点数类型有两种：

1. 单精度浮点型（FLOAT）
2. 双精度浮点型（DOUBLE）

定点数类型有一种：

1. DECIMAL

浮点数类型和顶点数类型都可以用（M,N）来表示。

- M称为精度，表示**总共**的位数；
- N称为标度，表示小数的位数；

> 注意：
>
> M称为精度，表示**总共**的位数。例如（5,1），即整数位只能有4位，小数位只能有1位，即它们总共有5位。

*MySQL中的小数类型*

| 类型名称           | 说明               | 存储需求 |
| ------------------ | ------------------ | -------- |
| FLOAT              | 单精度浮点数       | 4字节    |
| DOUBLE             | 双精度浮点数       | 8字节    |
| DECIMAL(M,D) , DEC | 压缩的“严格”定点数 | M+2字节  |

**浮点数取值范围**

- FLOAT类型的取值范围如下：
  - 有符号的取值范围：-3.402823466E+38 ~ -1.175494351E-38
  - 无符号的取值范围：0和1.175494351E-38 ~ 3.402823466E+38
- DOUBLE类型的取值范围如下：
  - 有符号的取值范围：-1.797693148623157E+308 ~ -2.2250738585072014E-308
  - 无符号的取值范围：0和2.2250738585072014E-308 ~ 1.797693148623157E+308

**浮点数和定点数特性**

1. 无论是定点数还是浮点数类型，如果指定的精度超出精度范围，则会四色五入。

2. FLOAT和DOUBLE在不指定精度时，默认会按照实际的精度（由计算机硬件和操作系统决定）。

3. DECIMAL若不指定精度，则默认为(10,0)。

4. 浮点数相对于定点数的优点是在长度一定的情况下，浮点数能够表示更大的数据范围；它的缺点是会引起精度问题。

   > 浮点数在进行加减法和比较运算时容易出问题，所以在使用浮点数时需要注意，并尽量避免做浮点数比较。

5. 定点数以字符串形式存储，在对精度要求比较高的时候（如货币，科学数据等）使用DECIMAL的类型比较好。

**测试验证**

创建表

```mysql
CREATE TABLE tmp(
 a DOUBLE(5,1),
 b FLOAT(5,1),
 c DECIMAL(5,1)
)
```

然后插入数据

```mysql
INSERT INTO tmp VALUES(5.16,5.15,5.163);
Query OK, 1 row affected, 1 warning (0.14 sec)
```

插入后的数据如下：

```mysql
mysql> select * from tmp;
+------+------+------+
| a    | b    | c    |
+------+------+------+
|  5.2 |  5.2 |  5.2 |
+------+------+------+
```

可以看到，a、b、c都进行了四舍五入。

插入数据的时候，提示了一个警告信息，使用`SHOW WARNINGSC`查看

```mysql
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------+
| Level | Code | Message                                |
+-------+------+----------------------------------------+
| Note  | 1265 | Data truncated for column 'c' at row 1 |
+-------+------+----------------------------------------+
```

可以看到仅仅字段c提示了被截断的警告信息。

现在，去掉精度设置，重新创建表，如下：

```mysql
CREATE TABLE tmp(
    a DOUBLE,
    b FLOAT,
    c DECIMAL
)
```

使用`DESC table_name`查看表信息，如下：

```mysql
mysql> DESC tmp;
+-------+---------------+------+-----+---------+-------+
| Field | Type          | Null | Key | Default | Extra |
+-------+---------------+------+-----+---------+-------+
| a     | double        | YES  |     | NULL    |       |
| b     | float         | YES  |     | NULL    |       |
| c     | decimal(10,0) | YES  |     | NULL    |       |
+-------+---------------+------+-----+---------+-------+
```

可以看到DECIMAL的默认精度为(10,0)。

### 1.1.3、日期与实践类型

日期与时间数据类型

| 类型名称  | 日期格式            | 日期范围                                        | 存储需求 |
| --------- | ------------------- | ----------------------------------------------- | -------- |
| YEAR      | YYYY                | 1901~2155                                       | 1字节    |
| TIME      | HH:MM:SS            | -838:59:59~838:59:59                            | 3字节    |
| DATE      | YYYY-MM-DD          | 1000-01-01~999-12-31                            | 3字节    |
| DATETIME  | YYYY-MM-DD HH:MM:SS | 1000-01-01 00:00:00~999-12-31 23:59:59          | 8字节    |
| TIMESTAMP | YYYY-MM-DD HH:MM:SS | 1970-01-01 00:00:01 UTC~2038-01-19 03:14:07 UTC | 4字节    |

#### YEAR

YEAR类型是一个单字节类型，用于表示年，在存储时只需要1字节。

1. 以4位字符串或者4位数字格式表示YEAR，范围为'1901'~'2155'。输入格式为'YYYY'或者YYYY。
2. 以2位字符串格式表示YEAR，范围为'00'到'99'。'00'~'69'和'70'~'99'范围的值分别被转换为2000~2069和1970~1999范围的YEAR值。'0'与'00'的作用相同。插入超过取值范围的值将会报错。
3. 以2位数字表示的YEAR，范围1-99。1~69和70~99范围的值分别被转换为2001~2069和1970~1999范围的YEAR值。注意：在这里0值将被转换为0000。而不是2000。

> 提示
>
> 两位整数范围与两位字符串范围稍有不同。例如：插入2000年，读者可以会使用数字格式0表示YEAR，实际上，插入数据库的值为0000，而不是所希望的2000。只有使用字符串格式的'0'或'00'，才可以被正确地解释为2000。非法YEAR值将被转换为0000。

#### TIME

TIME类型用在只需要时间信息的值，在存储时需要3直接，格式为'HH:MM:SS'。其中HH表示小时，MM表示分钟，SS表示秒。TIME类型的取值范围为-838:59:59~838:59:59。小时部分会如此大的原因是TIME类型不仅可以用于表示一天的时间（必须小于24小时），还可能使某个时间过去的时间或两个时间之间的时间间隔（可以大于24小时，或者甚至为负）。

可以使用各种格式指定TIME值：

1. 'D HH:MM:SS'格式的字符串。可以使用下面任何一种“非严格”的语法：'HH:MM:SS'，'HH:MM'，'D HH:MM'，'D HH'或'SS'。这里D表示日，可以取0~34之间的值。在插入数据库时，D被转换为小时保存，格式为“D*24+HH”。
2. 'HHMMSS'格式的、没有间隔符的字符串或者HHMMSS格式的数值，假定是有意义的时间。例如：'101112'被理解为'10:11:12'，但'109712'是不合法的（他有一个没有意义的分支部分），存储时将报错。

> 提示
>
> 为TIME列分配简写值时应注意：如果没有冒号，MySQL解释值时，最右边的两位表示秒。（MySQL解释TIME值为过去的时间而不是当天的时间。）例如，读者可能认为'1112'和1112表示11:12:00（11点12分），但MySQL将他们解释为00:11:12（11分12秒）。同样'12'和12被解析为00:00:12。相反，TIME值中如果使用冒号则肯定被看作当前的时间。也就是说，'11:12'表示11:12:00，而不是00:11:12。



> 提示
>
> 在使用'D HH'格式时，小时一定要使用双位数值，如果是小于10的小时数，应在前面加0。

#### DATE

DATE类型用在仅需日期值时，没有时间部分，在存储时需要3字节。日期格式为`'YYYY-MM-DD'`。其中`YYYY`表示年，`MM`表示月，`DD`表示日。在给DATE类型的字段赋值时，可以使用**字符串类型**或者**数字类型**的数据插入，只要符合DATE的日期格式即可。

1. 以`'YYYY-MM-DD'`或者`'YYYYMMDD'`字符串格式表示的日期，取值范围为`'1000-01-01'` ~ `'9999-12-3'`。
2. 以`'YY-MM-DD'`或者`'YYMMDD'`字符串格式表示的日期，在这里YY表示两位年值。包含两位年值的日期会令人模糊，因为不知道世纪。MySQL使用一下规则解释两位年值：
   - `'00 ~ 69'`范围的年值转换为`'2000 ~ 2069'`；
   - `'70 ~ 99'`范围的年值转换为`'1970 ~ 1999'`；
3. 使用`CURRENT_DATE`或者`NOW()`，插入当前系统日期。

> MySQL允许“不严格”语法：任何标点符号都可以用作日期部分之间的间隔符。例如：'98-11-31'、'98.11.31'、'98/11/31'和'98@11@31'是等价的，这些值也可以正确的插入到数据库中。

#### DATETIME

DATETIME类型用于需要同时包含日期和时间信息的值，在存储时需要8字节。日期格式为'YYYY-MM-DD HH:MM:SS'，其中YYYY表示年，MM表示月，DD表示日，HH表示小时，MM表示分钟，SS表示秒。在给DATETIME类型的字符赋值时，可以使用**字符串类型**或者**数字类型**的数据插入，只要符合DATETIME的日志格式即可。

1. 以'YYYY-MM-DD HH:MM:SS'或者'YYYYMMDDHHMMSS'字符串格式表示的值，取值范围为'1000-01-01 00:00:00' ~ '9999-12-3 23:59:59'。

2. 以'YY-MM-DD HH:MM:SS'或者'YYMMDDHHMMSS'字符串格式表示的日期，在这里YY表示两位年值。MySQL使用一下规则解释两位年值：

   - `'00 ~ 69'`范围的年值转换为`'2000 ~ 2069'`；
   - `'70 ~ 99'`范围的年值转换为`'1970 ~ 1999'`；

3. 以YYYYMMDDHHMMSS或者YYMMDDHHMMSS数字格式表示的日期和时间。

4. 使用`NOW()`，插入当前系统日期和时间。

   > NOW()函数返回当前系统的日期和时间值，格式为'YYYY-MM-DD HH:MM:SS'。

> 提示
>
> MySQL允许“不严格”语法：任何标点符号都可以用作日期部分或时间部分之间的间隔符。例如：'98-12-31 11:30:45'、'98.12.31 11+30+45'、'98/12/31 11*30*45'和'98@12@31 11^30^45'是等价的，这些值都可以正确地插入数据库。

#### TIMESTAMP

TIMESTAMP显示的格式与DATETIME相同，显示宽度固定在19个字符，日期格式为YYYY-MM-DD HH:MM:SS，在存储时需要4字节。TIMESTAMP列的取值范围小于DATATIME的取值范围，为'1970-01-01 00:00:01' UTC ~ '2038-01-19 01:14:07' UTC。其中，UTC（Corrdinated Universal Time）为世界标准时间，因此在插入数据时，需要保证在合法的取值范围。

TIMESTAMP与DATETIME除了存储字节和支持的范围不同之外，还有一个最大的区别就是：DATETIMT在存储日期数据时，按实际输入的格式存储，即输入什么就存储什么，与时区无关；而TIMESTAMP值的存储是以UTC（世界标准时间）格式保存的，存储时对当前时区进行转换，检索时再转换回当前时区。查询时，不同时区显示的时间值是不同的。

示例：

```mysql
-- 创建表
CREATE TABLE temp (
   ts TIMESTAMP
);
-- 插入数据
INSERT INTO temp VALUES (NOW());
-- 查询数据
SELECT * FROM temp;
+---------------------+
| ts                  |
+---------------------+
| 2020-07-08 20:07:57 |
+---------------------+
-- 设置时区
SET time_zone='+10:00';
-- 再次查询数据
mysql> SELECT * FROM temp;
+---------------------+
| ts                  |
+---------------------+
| 2020-07-08 22:07:57 |
+---------------------+
```

> 提示：
>
> 如果为一个DATATIME或TIMESTAMP对象分配一个DATE值，那么结果值的时间部分将被设置为'00:00:00'，因为DATE值未包含时间信息。如果为一个DATE对象分配一个DATETIME或TIMESTAMP值，那么结果值的时间部分被删除，因为DATE值为包含时间信息。

### 1.1.4、文本字符串类型

字符串类型用来存储字符串数据，除了可以存储字符串数据之外，还可以存储其他数据，比如图片和声音的二进制数据。MySQL支持两类字符型数据：文本字符串和二进制字符串。文本字符串可以进行区分或者不区分大小写的串比较，还可以进行模式匹配查找。在MySQL中，文本字符串类型是指CHAR、VARCHAR、TEXT、ENUM和SET。

*MySQL中文本字符串数据类型：*

| 类型名称   | 说明                                        | 存储需求                                                |
| ---------- | ------------------------------------------- | ------------------------------------------------------- |
| CHAR(M)    | 固定长度的非二进制字符串                    | M字节，1<=M<=255                                        |
| VARCHAR(M) | 变长非二进制字符串                          | L+1字节，在此L<=M和1<=M<=255                            |
| TINYTEXT   | 非常小的非二进制字符串                      | L+1字节，在此L<2<2^8                                    |
| TEXT       | 小的非二进制字符串                          | L+2字节，在此L<2<2^16                                   |
| MEDIUMTEXT | 中等大小的非二进制字符串                    | L+3字节，在此L<2<2^24                                   |
| LONGTEXT   | 大的非二进制字符串                          | L+4字节，在此L<2<2^32                                   |
| ENUM       | 枚举类型，只能有一个枚举字符串值            | 1或2字节，取决于枚举值的数目（最大值为65535）           |
| SET        | 一个设置，字符串对象可以有零个或多个SET成员 | 1、2、3、4或8字节，取决于集合成员的数量（最多为个成员） |

#### 1. CHAR和VARCHAR

CHAR(M)为固定长度字符串，在定义时指定字符串列长。当保存时在右侧填充空格，以达到指定的长度。M表示列长度，M的范围是0~255个字符。例如，CHAR(4)定义了一个固定长度的字符串列，其包含的字符个数最大为4。当检索到CHAR值时，尾部的空格将被删除。

VARCHAR(M)是长度可变的字符串，M表示最大列长度。M的范围是0~65535。VARCHAR的最大实际长度是由最长的行的大小和使用的字符集确定，而其实占用的空间为字符串的实际长度加1。例如VARCHAR(50)定义了一个最大长度为50的字符串，如果插入的字符串只有10个字符，则实际存储的字符串为10个字符和一个字符串结束字符。VARCHAR在值保存和检索时尾部的空格仍保留。

如下表格将说明CHAR和VARCHAR之间的差别：将不同字符串保存到CHAR(4)和VARCHAR(4)列。

| 插入值     | CHAR(4)  | 存储需求 | VARCHAR(4) | 存储需求 |
| ---------- | -------- | -------- | ---------- | -------- |
| `''`       | `'    '` | 4字节    | `''`       | 1字节    |
| `'ab'`     | `'ab  '` | 4字节    | `'ab'`     | 3字节    |
| `'abc'`    | `'abc '` | 4字节    | `'abc'`    | 4字节    |
| `'abcd'`   | `'abcd'` | 4字节    | `'abcd'`   | 5字节    |
| `'abcdef'` | `'abcd'` | 4字节    | `'abcd'`   | 5字节    |

对比结果可以看到，CHAR(4)定义了固定长度为4的列，不管存入的数据长度为多少，所占用的空间均为4字节；VARCHAR(4)定义的列所占的字节数为实际长度加1。



#### 2. TEXT

TEXT列保存非二进制字符串，如文章内容、评论等。当保存或查询TEXT列的值时，不删除尾部空格。

TEXT类型分为4中：TINYTEXT、TEXT、MEDIUMTEXT和LONGTEXT。

不同类型的TEXT类型的存储空间和数据长度不同：

1. TINYINTEXT最大长度为255（2^8-1）字符的TEXT列。
2. TEXT最大长度为65535（2^16-1）字符的TEXT列。
3. MEDIUMTEXT最大长度为16777215（2^24-1）字符的TEXT列。
4. LONGTEXT最大长度为4294967295（2^32-1）字符的TEXT列。

示例：

```mysql
CREATE TABLE temp(
    a TINYTEXT,
    b TEXT,
    c MEDIUMTEXT,
    d LONGTEXT
);
```

#### 3. ENUM

ENUM类型就是枚举类型，有如下特性：

1. ENUM类型的字段在取值时，只能值指定的枚举列表中取。
2. 从枚举列表中只能取一个值。
3. 创建的成员中有空格时，其尾部的空格将自动被删除。
4. ENUM值在内部用整数表示，并且每个枚举值均有一个索引值。
5. 列表值所允许的成员值从1开始编号，MySQL存储的就是这个索引编号。
6. 枚举最多可以有65536个元素。

ENUM值依照列索引顺序排列，并且空字符串排在非空字符串前，NULL值排在其他所有的枚举值前。如下表所示：

| 值     | 索引 |
| ------ | ---- |
| NULL   | NULL |
| ''     | 0    |
| first  | 1    |
| second | 2    |
| third  | 3    |

示例：

```mysql
CREATE TABLE temp (
  e ENUM('first','second','third')
)
```

插入数据

```mysql
INSERT INTO temp VALUES ('first'),('second'),('third'),(NULL);
```

前面已经说过，ENUM值在内部用整数表示，并且每个枚举值均有一个索引值。所以除了插入枚举之外，还可以直接插入索引，如下：

```mysql
INSERT INTO temp VALUES (1),(2),(3),(NULL);
```

#### 4. SET

SET类型就是集合类型，可以多选，有如下特性：

1. SET是一个字符串对象集合，可以有零或多个值。
2. SET列最多可以有64个成员，其值为表创建时规定的一列值。
3. 指定多个SET成员列值时，各成员之间用逗号(,)隔开。
4. 与ENUM类型相同，SET值在内部用整数表示。
5. 列表中每一个值都有一个索引编号。
6. 创建的成员中有空格时，其尾部的空格将自动被删除。
7. 如果插入SET字段中列值有重复，则MySQL自动删除重复的值。
8. 插入SET字段的值的顺序并不重要，MySQL会在存入数据库时按照定义的顺序显示。
9. 如果插入了不正确的值，默认情况下，MySQL将忽视这些值，并给出错误信息。
10. 与ENUM一样可以通过索引插入，但是每次只能插入一个值。
11. 索引0代表空字符串，索引NULL代表NULL。

示例：

```mysql
CREATE TABLE temp (
  s SET('a','b','c','d','e')
)
```

插入数据

```mysql
INSERT INTO temp VALUES ('a'),('a,b'),('a,b,c'),('e,c,a'),('e,e,e');
```

查询

```mysql
mysql> select * from temp;
+-------+
| s     |
+-------+
| a     |
| a,b   |
| a,b,c |
| a,c,e |
| e     |
+-------+
```

可以看到，第4条数据按定义的顺序显示的。第5条数据去除了重复，只有一个e。

测试插入不存在的值

```mysql
mysql> INSERT INTO temp VALUES ('n');
ERROR 1265 (01000): Data truncated for column 's' at row 1
```

给出了错误信息。

与ENUM一样，也可以插入索引

```mysql
mysql> INSERT INTO temp VALUES (0),(1);
Query OK, 2 rows affected (0.11 sec)
Records: 2  Duplicates: 0  Warnings: 0
```

需要注意的是，通过索引的方式插入，每次只能插入一个元素。

如果插入多个元素：

```mysql
mysql> INSERT INTO temp VALUES (1,2);
ERROR 1136 (21S01): Column count doesn't match value count at row 1
```

### 1.1.5、二进制字符串类型

#### 1.3.1、BIT类型

BIT类型是位字段类型。有如下特性：

1. M表示每个值的位数，范围为1~64。

2. 如果M被省略，默认为1。
3. 如果BIT(M)列分配的值的长度小于M位，就在值的左边用0填充。

示例：

```mysql
CREATE TABLE temp (
  b BIT(4)
)
```

插入值：

```mysql
INSERT INTO temp VALUES (2),(9),(15)
```

查看十六进制（命令行显示的16进制）：

```mysql
mysql> SELECT b FROM temp;
+------------+
| b          |
+------------+
| 0x02       |
| 0x09       |
| 0x0F       |
+------------+
```

查看十进制（+0显示十进制）：

```mysql
mysql> SELECT b+0 FROM temp;
+------+
| b+0  |
+------+
|    2 |
|    9 |
|   15 |
+------+
```

查看二进制（SQLyag工具显示的是二进制）：

```mysql
SELECT b FROM temp;
+------------+
| b          |
+------------+
| b'10'      |
| b'1001'    |
| b'1111'    |
+------------+
```

> 提示
>
> 默认情况下，MySQL不可以插入超出该列允许范围的值，因而插入的数据要确保插入的值在指定的范围内。

#### 1.3.2、BINARY和VARBINARY类型

BINARY和VARBINAR类型类似于CHAR和VARCHAR，不同的是他们包含二进制直接字符串。

BINARY类型的长度是固定的，指定长度之后，不足最大长度的，将在它们右边填充'\0'补齐以达到指定长度。例如：指定列数据类型为BINARY(3)，当插入'a'时，存储的内容实际为'a\0\0'，当插入'ab'时，实际存储的内容为'ab\0'，不管存储的内容是否达到指定的长度，其存储空间均为指定的值M。

VARBINARY类型的长度是可变的，指定好长度之后，其长度可以在0到最大值之间。例如指定数据类型为VARBINARY(20)，如果插入的值的长度只有10，则实际存储空间为10加1，即实际占用的空间为字符串的实际长度加1。

示例：

创建表

```mysql
CREATE TABLE temp (
    b BINARY(3),
    vb VARBINARY(3)
);
```

插入数据

```mysql
INSERT INTO temp VALUE (5,5);
```

查看其占用长度

```mysql
mysql> SELECT LENGTH(b),LENGTH(vb) FROM temp;
+-----------+------------+
| LENGTH(b) | LENGTH(vb) |
+-----------+------------+
|         3 |          1 |
+-----------+------------+
```

查看实际值

```mysql
mysql> SELECT b,vb,b='5',b='5\0\0',vb='5',vb='5\0\0' FROM temp;
+----------+--------+-------+-----------+--------+------------+
| b        | vb     | b='5' | b='5\0\0' | vb='5' | vb='5\0\0' |
+----------+--------+-------+-----------+--------+------------+
| 0x350000 | 0x35   |     0 |         1 |      1 |          0 |
+----------+--------+-------+-----------+--------+------------+
```

#### 1.3.3、BLOB类型

BLOB是一个二进制大对象，用来存储可变数量的数据。BLOB类型费为4种：`TINYBLOB`、`BLOB`、`MEDIUMBLOB`、`LONGBLOB`。它们可容纳值的最大长度不同。

| 数据类型   | 存储范围                         |
| ---------- | -------------------------------- |
| TINYBLOB   | 最大长度255(2^8-1)B              |
| BLOB       | 最大长度65535(2^16-1)B或64KB     |
| MEDIUMBLOB | 最大长度16777215(2^24)-1或16MB   |
| LONGBLOB   | 最大长度4294967295(2^32)-1B或4GB |

BLOB列存储的是二进制字符串（字节字符串），TEXT列存储的是非二进制字符串（字符字符串）。BLOB列没有字符串，并且排序和比较基于列字节的数值；TEXT列有一个字符串集，并且根据字符串对值进行排序和比较。

## 2、如何选择数据类型

MySQL提供了大量的数据类型，为了优化存储，提高数据库性能，在任何情况下均应使用最精确的类型，即在所有可以表示该列值的类型种，该类型使用的存储最少。

### 2.1、整数和浮点数

1. 如果不需要小数部分，就使用整数类保存数据。
2. 如果需要表示小数部分，就使用浮点数类型。
3. 对于浮点数据列，存储的数值会对该列定义的小数位进行四舍五入。
4. 例如，假设列的值的范围为1~99999，若使用整数，则MEDIUMINT UNSIGNED是最好的类型。
5. 若需要存储小数，则使用FLOAT类型。
6. 浮点数类型包括FLOAT和DOUBLE类型。DOUBLE类型经度比FLOAT类型高，因此要求存储精度较高时应选择DOUBLE类型。

### 2.2、浮点数和定点数

1. 浮点数FLOAT、DOUBLE相对于定点数DECIMAL的优势是：在长度一定的情况下，浮点数能表示更大的数据范围。
2. 由于浮点数容易产生误差，因此对精度要求比较高时，建议使用DECIMAL来存储。
3. DECIMAL在MySQL中是以字符串存储的，用于定义货币等对精度要求较高的数据。
4. 在数据迁移中，float(M,D)是非标准SQL定义，数据库迁移可能会出现问题，最好不要这样使用。
5. 浮点数进行减法和比较运算时也容易出现问题，因此在进行计算的时候，一定要小心
6. 进行数值比较时，最好使用DECIMAL类型。

### 2.3、日期与世间类型

1. 如果只需要记录年份，则使用YEAR类型即可。
2. 如果只记录时间，则使用TIME类型。
3. 如果同时需要记录日期和时间，则可以使用TIMESTAMP和DATATIIME类型。
4. 由于TIMESTAMP类型的取值范围小于DATETIME类型，因此在存储范围较大的情况下最好使用DATETIME。
5. TIMESTAMP有一个DATETIME不具备的属性。默认情况下，当插入一条记录但并没有指定TIMESTAMP这个列值时，MySQL会把TIMESTAMP列设为当前系统时间。因此当需要插入记录的同时插入当前时间，使用TIMESTAMP最好。
6. TIMESTAMP在空间上比DATETIME更有效。

### 3.4、CHAR与VARCHAR之间的特点与选择

CHAR和VARCHAR的区别如下：

- CHAR是固定长度字符，VARCHAR是可变长度字符。
- CHAR会自动删除插入数据的尾部空格，VARCHAR不会删除尾部空格。

CHAR是固定长度，多以它的处理速度比VARCHAR的速度更快，但是它的缺点是浪费存储空间，所以对存储不大但在速度上有要求的可以使用CHAR类型，反之可以使用VARCHAR类型来实现。

存储引擎对于选择CHAR和VARCHAR的影响：

- 对于MyISAM存储引擎：最好使用固定长度的数据列代替可变长度的数据列。这样可以使整个表静态化，从而使数据检索更快，用空间换时间。
- 对于InnoDB存储引擎：使用可变长度的数据里，因此InnoDB数据表的存储格式不分固定长度和可变长度，因此使用CHAR不一定比使用VARCHAR更好，但由于VARCHAR使按照实际的长度存储的，比较节省空间，所以对磁盘I/O和数据存储只总量比较好。

### 3.5、ENUM和SET

1. 需要从多个值上选取一个时，可以使用ENUM，比如性别字段。
2. 需要取多个值的时候，适合使用SET类型，比如一个人的兴趣爱好。

ENUM和SET的值是以字符串形式出现的，但在内部，MySQL是以数值的形式存储它们的。

### 3.6、BLOB和TEXT

- BLOB是二进制字符串，TEXT是非二进制字符串，两者均可存储大容量的信息。

- BLOB只要存储图片、音频信息等，而TEXT只能存储纯文本文件。

## 3、常见运算符介绍

### 3.1、运算符概述

运算符是告诉MySQL执行特定算术或逻辑操作的符号。MySQL的内部运算符很丰富，主要有四大类，分别是算术运算符、比较运算符、逻辑运算符、位运算符。

1. 算术运算符

   算术运算符用于各类数值运算，包括（+）、减（-）、乘（*）、除（/）、求余（或称模运算，%）。

2. 比较运算符

   比较运算符用于比较运算，包括大于（>）、小于（<）、等于（=）、大于等于（>=）、小于等于（<=）、不等于（!=）、IN、BETWEEN、AND、IS NULL、GREATEST、LEAST、LIKE、REGEXPD等。

3. 逻辑运算符

   逻辑运算符的求值所得结果均为1（TRUE）、0（FALSE），这类运算符有逻辑非（NOT或者!）、逻辑与（AND或者&&）、逻辑或（OR或者||）、逻辑异或（XOR）。

4. 位运算符

   位运算符参与运算的操作数按二进制位进行运算，包括位与（&）、位或（|）、位非（~）、位异或（^）、左移（<<）、右移（>>）6种。

### 3.2、算术运算符

算术运算符是SQL中最基本的运算符。

| 运算符 | 作用     |
| ------ | -------- |
| +      | 加法运算 |
| -      | 减法运算 |
| *      | 乘法运算 |
| /      | 除法运算 |
| %      | 求余运算 |

示例：

创建表

```mysql
CREATE TABLE temp(
    num INT
);
```

插入数据

```mysql
INSERT INTO temp VALUES (64);
```

算术运算

```mysql
mysql> SELECT num,num+5,num-5,num*5,num/5,num%5,num/0,num%0 FROM temp;
+------+-------+-------+-------+---------+-------+-------+-------+
| num  | num+5 | num-5 | num*5 | num/5   | num%5 | num/0 | num%0 |
+------+-------+-------+-------+---------+-------+-------+-------+
|   64 |    69 |    59 |   320 | 12.8000 |     4 |  NULL |  NULL |
+------+-------+-------+-------+---------+-------+-------+-------+
```

如上结果所示：

- 如果不能被整除，则保留四位小数。
- 在数学运算时，除数为0是没有意义的，因此除法运算中除数不能为0，如果被0除，则返回结果为NULL。

### 3.3、比较运算符

一个比较运算符的结果总是1、0或者是NULL。比较运算符经常在SELECT的查询条件子句中使用，用来查询满足指定条件的记录。

| 运算符      | 作用                               |
| ----------- | ---------------------------------- |
| =           | 等于                               |
| <=>         | 安全等于                           |
| <>(!=)      | 不等于                             |
| <=          | 小于等于                           |
| >=          | 大于等于                           |
| >           | 大于                               |
| <           | 小于                               |
| IS NULL     | 判断一个值是否为NULL               |
| IS NOT NULL | 判断一个值是否不为NULL             |
| LEAST       | 在有两个或多个参数时，返回最小值   |
| GREATEST    | 在有两个或多个参数是，返回最大值   |
| BETWEEN AND | 判断一个值是否落在两个值之间       |
| ISNULL      | 与IS NULL作用相同                  |
| IN          | 判断一个值是IN列表中的任意一个值   |
| NOT IN      | 判断一个值不是IN列表中的任意一个值 |
| LIKE        | 通配符匹配                         |
| REGEXP      | 正在表达式匹配                     |



### 3.4、逻辑运算符

在SQL中，所有逻辑运算符的求职所得结果均为TRUE，FALSE或NULL。在MySQL中，它们体现为1（TRUE）、0（FALSE）或NULL。逻辑运算符大多数与不同的数据库SQL通用。

MySQL中的逻辑运算符

| 运算符     | 作用     |
| ---------- | -------- |
| NOT或者!   | 逻辑非   |
| AND或者&&  | 逻辑与   |
| OR或者\|\| | 逻辑或   |
| XOR        | 逻辑异或 |

#### 3.4.1、NOT或者！

逻辑非运算符NOT或者!表示：

- 当操作数为0时，所得值为1；
- 当操作数为**非零值**时，所得值为0；
- 当操作数为NULL时，所得的返回值为NULL;

示例

```mysql
mysql> SELECT NOT 10, NOT (1-1), NOT -5, NOT NULL, NOT 1+1;
+--------+-----------+--------+----------+---------+
| NOT 10 | NOT (1-1) | NOT -5 | NOT NULL | NOT 1+1 |
+--------+-----------+--------+----------+---------+
|      0 |         1 |      0 |     NULL |       0 |
+--------+-----------+--------+----------+---------+
1 row in set (0.00 sec)

mysql> SELECT ! 10, ! (1-1), ! -5, ! NULL , ! 1+1;
+------+---------+------+--------+-------+
| ! 10 | ! (1-1) | ! -5 | ! NULL | ! 1+1 |
+------+---------+------+--------+-------+
|    0 |       1 |    0 |   NULL |     1 |
+------+---------+------+--------+-------+
1 row in set, 5 warnings (0.00 sec)
```

如上结果所示：

- 10为非零值，所以所得结果为0。
- (1-1)为0，所以所得结果为1。
- -5为非零值，所以所得结果为0。
- 操作数为NULL，所以所得结果为NULL。

注意最后一列，可以看出NOT和!所得的结果不同。这是因为NOT与!的优先级不同：

- NOT的优先级低于+，因此NOT 1+1相当于NOT (1+1)，先计算1+1，然后再进行NOT运算，因此,操作数不为0，因此NOT 1+1的结果是0。

- !的优先级要高于+，运算，因此! 1+1相当于(!1)+1，先计算!1，结果为0，再加1，最后结果为1。

> 提示
>
> 在使用运算符运算时，一定要注意不同运算符的优先级不同。如果不能确定计算顺序，最好使用括号，以保证运算结果的正确。

#### 3.4.2、AND或者&&

逻辑与运算符AND或者&&表示：

- 当所有操作数均为**非零值**并且不为NULL时，计算所得结果为1；
- 当一个或多个操作数为0时，所得结果为0；
- 其余情况返回值为NULL；

示例：

```mysql
mysql> SELECT 1 AND -1, 1 AND 0, 1 AND NULL, 0 AND NULL;
+----------+---------+------------+------------+
| 1 AND -1 | 1 AND 0 | 1 AND NULL | 0 AND NULL |
+----------+---------+------------+------------+
|        1 |       0 |       NULL |          0 |
+----------+---------+------------+------------+
1 row in set (0.00 sec)

mysql> SELECT 1 && -1, 1 && 0, 1 && NULL, 0 && NULL;
+---------+--------+-----------+-----------+
| 1 && -1 | 1 && 0 | 1 && NULL | 0 && NULL |
+---------+--------+-----------+-----------+
|       1 |      0 |      NULL |         0 |
+---------+--------+-----------+-----------+
1 row in set, 4 warnings (0.00 sec)
```

如上结果所示，AND和&&的作用相同。

> 提示
>
> AND运算符可以有多个操作数，需要注意的是：多个操作数运算时，AND两边一定要使用空格隔开，不然会影响结果的正确性。

#### 3.4.3、OR或者||

逻辑或运算符OR或者||表示：

- 当两个操作数均为非NULL值，且任意一个操作数为非零值时，结果为1，否则结果为0；
- 当有一个操作数为NULL，且另一个操作数为非零值时，则结果为1，否则结果为NULL；
- 当两个操作数均为NULL时，则所得结果为NULL；

示例：

```mysql
mysql> SELECT 1 OR -1 OR 0, 1 OR 2, 1 OR NULL, 0 OR NULL, NULL OR NULL;
+--------------+--------+-----------+-----------+--------------+
| 1 OR -1 OR 0 | 1 OR 2 | 1 OR NULL | 0 OR NULL | NULL OR NULL |
+--------------+--------+-----------+-----------+--------------+
|            1 |      1 |         1 |      NULL |         NULL |
+--------------+--------+-----------+-----------+--------------+
1 row in set (0.00 sec)

mysql> SELECT 1 || -1 || 0, 1 || 2, 1 || NULL, 0 || NULL, NULL || NULL;
+--------------+--------+-----------+-----------+--------------+
| 1 || -1 || 0 | 1 || 2 | 1 || NULL | 0 || NULL | NULL || NULL |
+--------------+--------+-----------+-----------+--------------+
|            1 |      1 |         1 |      NULL |         NULL |
+--------------+--------+-----------+-----------+--------------+
1 row in set, 6 warnings (0.00 sec)
```

如上结果所示，AND和&&的作用相同。

#### 3.4.4、XOR

逻辑异或运算符XOR表示：

- 当任意一个操作数为NULL，返回值为NULL；
- 对于非NULL的操作数，如果两个操作数都是非0值或者都是0值，则返回结果为0；
- 如果一个为0值，另一个为非0值，返回结果为1；

示例：

```mysql
mysql> SELECT 1 XOR 1, 0 XOR 0, 1 OR 0, 1 XOR NULL, 1 XOR 1 XOR 1;
+---------+---------+--------+------------+---------------+
| 1 XOR 1 | 0 XOR 0 | 1 OR 0 | 1 XOR NULL | 1 XOR 1 XOR 1 |
+---------+---------+--------+------------+---------------+
|       0 |       0 |      1 |       NULL |             1 |
+---------+---------+--------+------------+---------------+
1 row in set (0.00 sec)
```

> 提示：
>
> a XOR b的计算等同于（a AND (NOT b)）或者（(NOT A a) AND b）。

### 3.5、位运算符

#### 3.5.1、位或运算符（|）

位或运算的实质是将参与运算的几个数据按照对应的二进制数逐位进行逻辑或运算。对应的二进制位有一个或两个为1则该位的运算结果为1，否则为0。

示例

```mysql
mysql> select 10 | 15, 9 | 4 | 2;
+---------+-----------+
| 10 | 15 | 9 | 4 | 2 |
+---------+-----------+
|      15 |        15 |
+---------+-----------+
1 row in set (0.00 sec)
```

10的二进制数为1010，15的二进制数为1111，按位或运算之后，结果为1111，即整数15；9的二进制数值为1001，4的二进制数值为0100，2的二进制数值为0010，按位或运算之后，结果为1111，即整数15。其结果为一个64位无符号整数。

#### 3.5.2、位与运算符（&）

位与运算的实质是将参与运算的几个操作数按照对应的二进制数逐位进行逻辑与运算。对应的二进制位都为1则该位的运算结果为1，否则为0。

示例

```mysql
mysql> select 10 & 15, 9 & 4 & 2;
+---------+-----------+
| 10 & 15 | 9 & 4 & 2 |
+---------+-----------+
|      10 |         0 |
+---------+-----------+
1 row in set (0.00 sec)
```

10的二进制数为1010，15的二进制数为1111，按位与运算之后，结果为1010，即整数10；9的二进制数值为1001，4的二进制数值为0100，2的二进制数值为0010，按位与运算之后，结果为0000，即整数0。其结果为一个64位无符号整数。

#### 3.5.3、位异或运算符（^）

位异或运算的实质是将参与运算的两个数据按照对应的二进制数逐位进行逻辑异或运算。对应位的二进制数不同时，对应位的结果才为1。如果两个对应位数都为0或者都为1，则对应位的结果为0。

示例：

```mysql
mysql> select 10 ^ 15, 1 ^ 0, 1 ^ 1;
+---------+-------+-------+
| 10 ^ 15 | 1 ^ 0 | 1 ^ 1 |
+---------+-------+-------+
|       5 |     1 |     0 |
+---------+-------+-------+
1 row in set (0.07 sec)
```



#### 3.5.4、位左移运算符（<<）

位左移运算符`<<`使指定的二进制值的所有位都左移指定的位数。左移指定位数之后，左边高位的数值将被移出并丢弃，右边低位空出的位置用0补齐。语法格式为：expr << n。其中，n指定值expr要移位的位数。

示例：

```mysql
mysql> select 1<<2, 4<<2;
+------+------+
| 1<<2 | 4<<2 |
+------+------+
|    4 |   16 |
+------+------+
1 row in set (0.06 sec)
```

#### 3.5.5、位右移运算符（>>）

位右移运算符`>>`使指定的二进制值的所有位都右移指定的位数。右移指定位数之后，右边低位的数值将被移出并丢弃，左边高位空出的位置用0补齐。语法格式为：expr >> n。其中，n指定值expr要移位的位数。

示例：

```mysql
mysql> select 1>>1, 16>>2;
+------+-------+
| 1>>1 | 16>>2 |
+------+-------+
|    0 |     4 |
+------+-------+
1 row in set (0.00 sec)
```

#### 3.5.6、位取反运算符（~）

位取反运算的实质是将参与运算的数据按照对应的二进制数逐位反转，即1取反后变为0，0取反后变为1。

示例：

```mysql
mysql> select 5 & ~1;
+--------+
| 5 & ~1 |
+--------+
|      4 |
+--------+
1 row in set (0.04 sec)
```



> 提示
>
> MySQL经过位运算之后的数值是一个64位的无符号整数，1的二进制数值表示为最右边位1，其他为均为0，取反操作之后，除了最低位为0之外、其他位均变为1.

可以使用`BIN()`函数查看1取反之后的结果，SQL语句如下：

```mysql
mysql> select bin(~1);
+------------------------------------------------------------------+
| bin(~1)                                                          |
+------------------------------------------------------------------+
| 1111111111111111111111111111111111111111111111111111111111111110 |
+------------------------------------------------------------------+
1 row in set (0.15 sec)
```

### 3.6、运算符优先级

运算符按优先级由低到高排列

| 优先级 | 运算符                                             |
| ------ | -------------------------------------------------- |
| 最低   | =，:=                                              |
|        | \|\|，OR                                           |
|        | XOR                                                |
|        | &&，AND                                            |
|        | BETWEEN，CASE，WHEN，THEN，ELSE                    |
|        | =，<=>，>=，>，<=，<，<>，!=，IS，LIKE，REGEXP，IN |
|        | \|                                                 |
|        | &                                                  |
|        | <<，>>                                             |
|        | -，+                                               |
|        | *，/（DIV），%（MOD）                              |
|        | ^                                                  |
|        | -（负号），~（位反转）                             |
| 最高   | !                                                  |





