# Spring Cache



| 注解        | 描述                                                         |
| ----------- | ------------------------------------------------------------ |
| @Cacheable  | 表明Spring在调用方法之前，首先应该在缓存中查找方法的返回值。如果这个值能够找到，就会返回缓存的值。否则，这个方法就被被调用，返回值会放到缓存之中。 |
| @CachePut   | 表明Spring应该将方法的返回值放到缓存中。在方法的调用前并不会检查缓存，方法始终都会被调用。 |
| @CacheEvict | 表明Spring应该在缓存中清楚一个或多个条目。                   |
| @Caching    | 这时一个分组的注解，能够同时应用多个其他的缓存注解。         |



`@Cacheable`和`@CachePut`有一些属性是共有的。

| 属性      | 类型     | 描述                                                         |
| --------- | -------- | ------------------------------------------------------------ |
| value     | String[] | 要使用的缓存名称。                                           |
| condition | String   | SpEL表达式，如果得到的值是false的话，不会将缓存应用到方法调用上。 |
| key       | String   | SpEL表达式，用来计算自定义的缓存key。                        |
| unless    | String   | SpEl表达式，如果得到的值是true的话，返回值不会方法缓存之中。 |



Spring提供了多个用来定义缓存规则的SpEL扩展

| 表达式              | 描述                                                         |
| ------------------- | ------------------------------------------------------------ |
| `#root.args`        | 传递给缓存方法的参数，形式为数组。                           |
| `#root.caches`      | 该方法执行时所对应的缓存，形式为数组。                       |
| `#root.target`      | 目标对象。                                                   |
| `#root.targetClass` | 目标对象的类，是`#root.target.class`的简写形式。             |
| `#root.method`      | 缓存方法                                                     |
| `#root.methodName`  | 缓存方法的名字，是`#root.method.name`的简写形式。            |
| `#result`           | 方法调用的返回值（不要用在`@Cacheable`注解上）               |
| `#Argument`         | 任意的方法参数名（如`#argName`）或参数索引（如`#a0`或`#p0`） |



条件化缓存





**注意：**与`@Cacheable`和`@CachePut`不同，`@CacheEvict`能够应用在返回值为`void`的方法上，而`@Cacheable`和`@CachePut`需要非`void`的返回值，它将会作为放在缓存中的条目。因为@CacheEvict只是将条目从缓存中移除，因此它可以放在任意的方法上，甚至`void`方法。